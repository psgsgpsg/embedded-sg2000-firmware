###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.10.1.52143/W32 for ARM     19/Jan/2012  11:09:03 #
# Copyright 1999-2010 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Libraries\STM32F #
#                    2xx_StdPeriph_Driver\src\stm32f2xx_wwdg.c                #
#    Command line =  F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Libraries\STM32F #
#                    2xx_StdPeriph_Driver\src\stm32f2xx_wwdg.c -D             #
#                    USE_STDPERIPH_DRIVER -D STM32F2XX -D USE_STM3220F_EVAL   #
#                    -D USE_USB_OTG_FS -D RTC_CLOCK_SOURCE_LSE -lC            #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\ST #
#                    M3220F_EVAL\List\ -lA F:\Work\S&G2000\Firmware\DTG_EMS_S #
#                    YSTEM\Project\EWARM\STM3220F_EVAL\List\ -o               #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\ST #
#                    M3220F_EVAL\Obj\ --no_cse --no_unroll --no_inline        #
#                    --no_code_motion --no_tbaa --no_clustering               #
#                    --no_scheduling --debug --endian=little --cpu=Cortex-M3  #
#                    -e --fpu=None --dlib_config "C:\Program Files\IAR        #
#                    Systems\Embedded Workbench 6.0\arm\INC\c\DLib_Config_Ful #
#                    l.h" -I F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\ #
#                    EWARM\..\ -I F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Pro #
#                    ject\EWARM\..\..\Libraries\CMSIS\CM3\CoreSupport\ -I     #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F2xx\ -I   #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Libraries\STM32F2xx_StdPeriph_Driver\inc\ -I         #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Utilities\STM32_EVAL\ -I                             #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Utilities\STM32_EVAL\Common\ -I                      #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Utilities\STM32_EVAL\STM3220F_EVAL\ -I               #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Libraries\STM32_USB_OTG_Driver\inc\ -I               #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Libraries\STM32_USB_Device_Library\Core\inc\ -I      #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Libraries\STM32_USB_Device_Library\Class\msc\inc\    #
#                    -I F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM #
#                    \..\Usb\ -I F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Proj #
#                    ect\EWARM\..\Usb\Inc\ -I F:\Work\S&G2000\Firmware\DTG_EM #
#                    S_SYSTEM\Project\EWARM\..\Usb\src\ -I                    #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Libraries\STM32_USB_HOST_Library\Core\inc\ -I        #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Libraries\STM32_USB_HOST_Library\Class\MSC\inc\ -I   #
#                    F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\.. #
#                    \..\Libraries\STM32_USB_Device_Library\Class\cdc\inc\    #
#                    -Ol --use_c++_inline                                     #
#    List file    =  F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\ST #
#                    M3220F_EVAL\List\stm32f2xx_wwdg.lst                      #
#    Object file  =  F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Project\EWARM\ST #
#                    M3220F_EVAL\Obj\stm32f2xx_wwdg.o                         #
#                                                                             #
#                                                                             #
###############################################################################

F:\Work\S&G2000\Firmware\DTG_EMS_SYSTEM\Libraries\STM32F2xx_StdPeriph_Driver\src\stm32f2xx_wwdg.c
      1          /**
      2            ******************************************************************************
      3            * @file    stm32f2xx_wwdg.c
      4            * @author  MCD Application Team
      5            * @version V0.0.4
      6            * @date    13-January-2011
      7            * @brief   This file provides all the WWDG firmware functions.
      8            ******************************************************************************
      9            * @attention
     10            *
     11            * THE PRESENT FIRMWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS
     12            * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE
     13            * TIME. AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY
     14            * DIRECT, INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING
     15            * FROM THE CONTENT OF SUCH FIRMWARE AND/OR THE USE MADE BY CUSTOMERS OF THE
     16            * CODING INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS.
     17            *
     18            * <h2><center>&copy; COPYRIGHT 2011 STMicroelectronics</center></h2>
     19            ******************************************************************************
     20            */
     21          
     22          /* Includes ------------------------------------------------------------------*/
     23          #include "stm32f2xx_wwdg.h"
     24          #include "stm32f2xx_rcc.h"
     25          
     26          /** @addtogroup STM32F2xx_StdPeriph_Driver
     27            * @{
     28            */
     29          
     30          /** @defgroup WWDG 
     31            * @brief WWDG driver modules
     32            * @{
     33            */
     34          
     35          /** @defgroup WWDG_Private_TypesDefinitions
     36            * @{
     37            */
     38          
     39          /**
     40            * @}
     41            */
     42          
     43          /** @defgroup WWDG_Private_Defines
     44            * @{
     45            */
     46          
     47          /* ----------- WWDG registers bit address in the alias region ----------- */
     48          #define WWDG_OFFSET       (WWDG_BASE - PERIPH_BASE)
     49          
     50          /* Alias word address of EWI bit */
     51          #define CFR_OFFSET        (WWDG_OFFSET + 0x04)
     52          #define EWI_BitNumber     0x09
     53          #define CFR_EWI_BB        (PERIPH_BB_BASE + (CFR_OFFSET * 32) + (EWI_BitNumber * 4))
     54          
     55          /* --------------------- WWDG registers bit mask ------------------------ */
     56          
     57          /* CR register bit mask */
     58          #define CR_WDGA_Set       ((uint32_t)0x00000080)
     59          
     60          /* CFR register bit mask */
     61          #define CFR_WDGTB_Mask    ((uint32_t)0xFFFFFE7F)
     62          #define CFR_W_Mask        ((uint32_t)0xFFFFFF80)
     63          #define BIT_Mask          ((uint8_t)0x7F)
     64          
     65          /**
     66            * @}
     67            */
     68          
     69          /** @defgroup WWDG_Private_Macros
     70            * @{
     71            */
     72          
     73          /**
     74            * @}
     75            */
     76          
     77          /** @defgroup WWDG_Private_Variables
     78            * @{
     79            */
     80          
     81          /**
     82            * @}
     83            */
     84          
     85          /** @defgroup WWDG_Private_FunctionPrototypes
     86            * @{
     87            */
     88          
     89          /**
     90            * @}
     91            */
     92          
     93          /** @defgroup WWDG_Private_Functions
     94            * @{
     95            */
     96          
     97          /**
     98            * @brief  Deinitializes the WWDG peripheral registers to their default reset values.
     99            * @param  None
    100            * @retval None
    101            */

   \                                 In section .text, align 2, keep-with-next
    102          void WWDG_DeInit(void)
    103          {
   \                     WWDG_DeInit:
   \   00000000   80B5               PUSH     {R7,LR}
    104            RCC_APB1PeriphResetCmd(RCC_APB1Periph_WWDG, ENABLE);
   \   00000002   0121               MOVS     R1,#+1
   \   00000004   4FF40060           MOV      R0,#+2048
   \   00000008   ........           BL       RCC_APB1PeriphResetCmd
    105            RCC_APB1PeriphResetCmd(RCC_APB1Periph_WWDG, DISABLE);
   \   0000000C   0021               MOVS     R1,#+0
   \   0000000E   4FF40060           MOV      R0,#+2048
   \   00000012   ........           BL       RCC_APB1PeriphResetCmd
    106          }
   \   00000016   01BD               POP      {R0,PC}          ;; return
    107          
    108          /**
    109            * @brief  Sets the WWDG Prescaler.
    110            * @param  WWDG_Prescaler: specifies the WWDG Prescaler.
    111            *   This parameter can be one of the following values:
    112            *     @arg WWDG_Prescaler_1: WWDG counter clock = (PCLK1/4096)/1
    113            *     @arg WWDG_Prescaler_2: WWDG counter clock = (PCLK1/4096)/2
    114            *     @arg WWDG_Prescaler_4: WWDG counter clock = (PCLK1/4096)/4
    115            *     @arg WWDG_Prescaler_8: WWDG counter clock = (PCLK1/4096)/8
    116            * @retval None
    117            */

   \                                 In section .text, align 2, keep-with-next
    118          void WWDG_SetPrescaler(uint32_t WWDG_Prescaler)
    119          {
    120            uint32_t tmpreg = 0;
   \                     WWDG_SetPrescaler:
   \   00000000   0021               MOVS     R1,#+0
    121            /* Check the parameters */
    122            assert_param(IS_WWDG_PRESCALER(WWDG_Prescaler));
    123            /* Clear WDGTB[1:0] bits */
    124            tmpreg = WWDG->CFR & CFR_WDGTB_Mask;
   \   00000002   ....               LDR.N    R2,??DataTable6  ;; 0x40002c04
   \   00000004   1268               LDR      R2,[R2, #+0]
   \   00000006   32F4C072           BICS     R2,R2,#0x180
   \   0000000A   1100               MOVS     R1,R2
    125            /* Set WDGTB[1:0] bits according to WWDG_Prescaler value */
    126            tmpreg |= WWDG_Prescaler;
   \   0000000C   0143               ORRS     R1,R0,R1
    127            /* Store the new value */
    128            WWDG->CFR = tmpreg;
   \   0000000E   ....               LDR.N    R0,??DataTable6  ;; 0x40002c04
   \   00000010   0160               STR      R1,[R0, #+0]
    129          }
   \   00000012   7047               BX       LR               ;; return
    130          
    131          /**
    132            * @brief  Sets the WWDG window value.
    133            * @param  WindowValue: specifies the window value to be compared to the downcounter.
    134            *   This parameter value must be lower than 0x80.
    135            * @retval None
    136            */

   \                                 In section .text, align 2, keep-with-next
    137          void WWDG_SetWindowValue(uint8_t WindowValue)
    138          {
   \                     WWDG_SetWindowValue:
   \   00000000   81B0               SUB      SP,SP,#+4
    139            __IO uint32_t tmpreg = 0;
   \   00000002   0021               MOVS     R1,#+0
   \   00000004   0091               STR      R1,[SP, #+0]
    140          
    141            /* Check the parameters */
    142            assert_param(IS_WWDG_WINDOW_VALUE(WindowValue));
    143            /* Clear W[6:0] bits */
    144          
    145            tmpreg = WWDG->CFR & CFR_W_Mask;
   \   00000006   ....               LDR.N    R1,??DataTable6  ;; 0x40002c04
   \   00000008   0968               LDR      R1,[R1, #+0]
   \   0000000A   C909               LSRS     R1,R1,#+7
   \   0000000C   C901               LSLS     R1,R1,#+7
   \   0000000E   0091               STR      R1,[SP, #+0]
    146          
    147            /* Set W[6:0] bits according to WindowValue value */
    148            tmpreg |= WindowValue & (uint32_t) BIT_Mask;
   \   00000010   0099               LDR      R1,[SP, #+0]
   \   00000012   C0B2               UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000014   10F07F00           ANDS     R0,R0,#0x7F
   \   00000018   0843               ORRS     R0,R0,R1
   \   0000001A   0090               STR      R0,[SP, #+0]
    149          
    150            /* Store the new value */
    151            WWDG->CFR = tmpreg;
   \   0000001C   ....               LDR.N    R0,??DataTable6  ;; 0x40002c04
   \   0000001E   0099               LDR      R1,[SP, #+0]
   \   00000020   0160               STR      R1,[R0, #+0]
    152          }
   \   00000022   01B0               ADD      SP,SP,#+4
   \   00000024   7047               BX       LR               ;; return
    153          
    154          /**
    155            * @brief  Enables the WWDG Early Wakeup interrupt(EWI).
    156            * @param  None
    157            * @retval None
    158            */

   \                                 In section .text, align 2, keep-with-next
    159          void WWDG_EnableIT(void)
    160          {
    161            *(__IO uint32_t *) CFR_EWI_BB = (uint32_t)ENABLE;
   \                     WWDG_EnableIT:
   \   00000000   ....               LDR.N    R0,??DataTable6_1  ;; 0x420580a4
   \   00000002   0121               MOVS     R1,#+1
   \   00000004   0160               STR      R1,[R0, #+0]
    162          }
   \   00000006   7047               BX       LR               ;; return
    163          
    164          /**
    165            * @brief  Sets the WWDG counter value.
    166            * @param  Counter: specifies the watchdog counter value.
    167            *   This parameter must be a number between 0x40 and 0x7F.
    168            * @retval None
    169            */

   \                                 In section .text, align 2, keep-with-next
    170          void WWDG_SetCounter(uint8_t Counter)
    171          {
    172            /* Check the parameters */
    173            assert_param(IS_WWDG_COUNTER(Counter));
    174            /* Write to T[6:0] bits to configure the counter value, no need to do
    175               a read-modify-write; writing a 0 to WDGA bit does nothing */
    176            WWDG->CR = Counter & BIT_Mask;
   \                     WWDG_SetCounter:
   \   00000000   C0B2               UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000002   10F07F00           ANDS     R0,R0,#0x7F
   \   00000006   ....               LDR.N    R1,??DataTable6_2  ;; 0x40002c00
   \   00000008   0860               STR      R0,[R1, #+0]
    177          }
   \   0000000A   7047               BX       LR               ;; return
    178          
    179          /**
    180            * @brief  Enables WWDG and load the counter value.                  
    181            * @param  Counter: specifies the watchdog counter value.
    182            *   This parameter must be a number between 0x40 and 0x7F.
    183            * @retval None
    184            */

   \                                 In section .text, align 2, keep-with-next
    185          void WWDG_Enable(uint8_t Counter)
    186          {
    187            /* Check the parameters */
    188            assert_param(IS_WWDG_COUNTER(Counter));
    189            WWDG->CR = CR_WDGA_Set | Counter;
   \                     WWDG_Enable:
   \   00000000   C0B2               UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000002   50F08000           ORRS     R0,R0,#0x80
   \   00000006   ....               LDR.N    R1,??DataTable6_2  ;; 0x40002c00
   \   00000008   0860               STR      R0,[R1, #+0]
    190          }
   \   0000000A   7047               BX       LR               ;; return
    191          
    192          /**
    193            * @brief  Checks whether the Early Wakeup interrupt flag is set or not.
    194            * @param  None
    195            * @retval The new state of the Early Wakeup interrupt flag (SET or RESET)
    196            */

   \                                 In section .text, align 2, keep-with-next
    197          FlagStatus WWDG_GetFlagStatus(void)
    198          {
    199            return (FlagStatus)(WWDG->SR);
   \                     WWDG_GetFlagStatus:
   \   00000000   ....               LDR.N    R0,??DataTable6_3  ;; 0x40002c08
   \   00000002   0068               LDR      R0,[R0, #+0]
   \   00000004   C0B2               UXTB     R0,R0            ;; ZeroExt  R0,R0,#+24,#+24
   \   00000006   7047               BX       LR               ;; return
    200          }
    201          
    202          /**
    203            * @brief  Clears Early Wakeup interrupt flag.
    204            * @param  None
    205            * @retval None
    206            */

   \                                 In section .text, align 2, keep-with-next
    207          void WWDG_ClearFlag(void)
    208          {
    209            WWDG->SR = (uint32_t)RESET;
   \                     WWDG_ClearFlag:
   \   00000000   ....               LDR.N    R0,??DataTable6_3  ;; 0x40002c08
   \   00000002   0021               MOVS     R1,#+0
   \   00000004   0160               STR      R1,[R0, #+0]
    210          }
   \   00000006   7047               BX       LR               ;; return

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable6:
   \   00000000   042C0040           DC32     0x40002c04

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable6_1:
   \   00000000   A4800542           DC32     0x420580a4

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable6_2:
   \   00000000   002C0040           DC32     0x40002c00

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable6_3:
   \   00000000   082C0040           DC32     0x40002c08
    211          
    212          /**
    213            * @}
    214            */
    215          
    216          /**
    217            * @}
    218            */
    219          
    220          /**
    221            * @}
    222            */
    223          
    224          /******************* (C) COPYRIGHT 2011 STMicroelectronics *****END OF FILE****/

   Maximum stack usage in bytes:

     Function            .cstack
     --------            -------
     WWDG_ClearFlag           0
     WWDG_DeInit              8
     WWDG_Enable              0
     WWDG_EnableIT            0
     WWDG_GetFlagStatus       0
     WWDG_SetCounter          0
     WWDG_SetPrescaler        0
     WWDG_SetWindowValue      4


   Section sizes:

     Function/Label      Bytes
     --------------      -----
     WWDG_DeInit           24
     WWDG_SetPrescaler     20
     WWDG_SetWindowValue   38
     WWDG_EnableIT          8
     WWDG_SetCounter       12
     WWDG_Enable           12
     WWDG_GetFlagStatus     8
     WWDG_ClearFlag         8
     ??DataTable6           4
     ??DataTable6_1         4
     ??DataTable6_2         4
     ??DataTable6_3         4

 
 146 bytes in section .text
 
 146 bytes of CODE memory

Errors: none
Warnings: none
